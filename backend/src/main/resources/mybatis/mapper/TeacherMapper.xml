<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mw.education.dao.TeacherMapper">

  <resultMap id="TeacherResultMap" type="com.mw.education.domain.Teacher">
    <id property="id" column="id"/>
    <result property="name" column="name"/>
    <result property="password" column="password"/>
    <result property="code" column="code"/>
    <result property="collegeId" column="college_id"/>
    <result property="remark" column="remark"/>
  </resultMap>

  <resultMap id="TeacherAndCollegeResultMap" type="com.mw.education.domain.compose.TeacherAndCollege">
    <id property="teacher.id" column="id"/>
    <result property="teacher.name" column="name"/>
    <result property="teacher.password" column="password"/>
    <result property="teacher.code" column="code"/>
    <result property="teacher.collegeId" column="college_id"/>
    <result property="teacher.remark" column="remark"/>
    <result property="college.id" column="college_id"/>
    <result property="college.name" column="college_name"/>
    <result property="college.remark" column="college_remark"/>
  </resultMap>

  <select id="selectByPrimaryKey" resultMap="TeacherResultMap">
    SELECT * FROM teacher WHERE id = #{id}
  </select>

  <select id="selectAll" resultMap="TeacherResultMap">
    SELECT * FROM teacher
  </select>

  <select id="selectByPrimaryKeyJoinedCollege" resultMap="TeacherAndCollegeResultMap">
    SELECT t.*, c.name AS college_name, c.remark AS college_remark
    FROM teacher t
           LEFT JOIN college c ON t.college_id = c.id
    WHERE t.id = #{id}
  </select>

  <select id="selectAllJoinedCollege" resultMap="TeacherAndCollegeResultMap">
    SELECT t.*, c.name AS college_name, c.remark AS college_remark
    FROM teacher t
           LEFT JOIN college c ON t.college_id = c.id
  </select>

  <insert id="insert" parameterType="com.mw.education.domain.Teacher">
    INSERT INTO teacher (name, password, code, college_id, remark)
    VALUES (#{name}, #{password}, #{code}, #{collegeId}, #{remark})
  </insert>

  <update id="updateByPrimaryKey" parameterType="com.mw.education.domain.Teacher">
    UPDATE teacher
    SET name = #{name}, password = #{password}, code = #{code}, college_id = #{collegeId}, remark = #{remark}
    WHERE id = #{id}
  </update>

  <delete id="deleteByPrimaryKey" parameterType="int">
    DELETE FROM teacher WHERE id = #{id}
  </delete>

  <select id="selectByCode" resultMap="TeacherResultMap">
    SELECT * FROM teacher WHERE code = #{code}
  </select>

  <select id="countByCodeAndPassword" resultType="int">
    SELECT count(id) FROM teacher WHERE code = #{code} AND password = #{password}
  </select>

</mapper>
